<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1a4789">
    <title>MyInsurancePhoto.com - Bill Layne Insurance</title>
    
    <!-- Preload critical images for better performance -->
    <link rel="preload" as="image" href="https://raw.githubusercontent.com/BillLayne/bill-layne-images/377d90a5e9bb6cceeae1bb14c0bc28e1e0b0c699/Blog%20Images/prompt%201.webp">
    <link rel="preload" as="image" href="https://raw.githubusercontent.com/BillLayne/bill-layne-images/377d90a5e9bb6cceeae1bb14c0bc28e1e0b0c699/Blog%20Images/prompt%203.webp">
    
    <!-- Modern Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            position: relative;
        }
        
        /* NEW: Top Progress Bar */
        .progress-indicator {
            position: sticky;
            top: 0;
            background: white;
            z-index: 100;
            padding: 12px 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .progress-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 400px;
            margin: 0 auto;
        }
        
        .progress-step {
            flex: 1;
            text-align: center;
            position: relative;
        }
        
        .progress-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 15px;
            left: 50%;
            width: 100%;
            height: 2px;
            background: #e2e8f0;
            z-index: -1;
        }
        
        .progress-step.active::after {
            background: #1a4789;
        }
        
        .progress-step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #e2e8f0;
            color: #a0aec0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 4px;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .progress-step.active .progress-step-circle,
        .progress-step.completed .progress-step-circle {
            background: #1a4789;
            color: white;
        }
        
        .progress-step-label {
            font-size: 11px;
            color: #64748b;
            font-weight: 500;
        }
        
        .progress-step.active .progress-step-label {
            color: #1a4789;
            font-weight: 600;
        }
        
        /* Header - Simplified */
        .header {
            background: #1a4789;
            color: white;
            padding: 25px 20px;
            text-align: center;
        }
        
        .header-logo {
            width: 60px;
            height: 60px;
            margin: 0 auto 15px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .header-logo img {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }
        
        .header h1 {
            font-size: 24px;
            margin-bottom: 8px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 15px;
            opacity: 0.9;
            line-height: 1.4;
        }
        
        /* NEW: Welcome Section */
        .welcome-section {
            padding: 25px 20px;
            background: linear-gradient(135deg, #eff6ff 0%, #f0f9ff 100%);
            border-bottom: 1px solid #e2e8f0;
            text-align: center;
        }
        
        .welcome-title {
            font-size: 20px;
            font-weight: 700;
            color: #1a4789;
            margin-bottom: 12px;
        }
        
        .welcome-text {
            font-size: 15px;
            color: #64748b;
            line-height: 1.5;
            margin-bottom: 20px;
        }
        
        .benefit-badges {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .benefit-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            background: white;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            color: #1a4789;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }
        
        .benefit-badge-icon {
            font-size: 16px;
        }
        
        /* Step Sections */
        .form-step {
            display: none;
            padding: 25px 20px;
            min-height: calc(100vh - 300px);
        }
        
        .form-step.active {
            display: block;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .step-header {
            margin-bottom: 25px;
            text-align: center;
        }
        
        .step-number {
            display: inline-block;
            width: 36px;
            height: 36px;
            background: #1a4789;
            color: white;
            border-radius: 50%;
            font-size: 18px;
            font-weight: 700;
            line-height: 36px;
            margin-bottom: 12px;
        }
        
        .step-title {
            font-size: 22px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
        }
        
        .step-subtitle {
            font-size: 14px;
            color: #64748b;
        }
        
        /* Selection Cards - Improved */
        .selection-cards {
            display: grid;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .selection-card {
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
            position: relative;
            overflow: hidden;
        }
        
        .selection-card:active {
            transform: scale(0.98);
        }
        
        .selection-card.active {
            border-color: #1a4789;
            background: linear-gradient(135deg, #eff6ff 0%, #f0f9ff 100%);
            box-shadow: 0 4px 12px rgba(26,71,137,0.15);
        }
        
        .selection-card.active::before {
            content: '✓';
            position: absolute;
            top: 15px;
            right: 15px;
            width: 24px;
            height: 24px;
            background: #1a4789;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }
        
        .selection-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .selection-card-icon {
            width: 48px;
            height: 48px;
            background: #f0f9ff;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .selection-card.active .selection-card-icon {
            background: #1a4789;
        }
        
        .selection-card-title {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
        }
        
        .selection-card-description {
            font-size: 13px;
            color: #64748b;
            line-height: 1.4;
            padding-left: 63px;
        }
        
        /* Photo Upload - Improved */
        .photo-requirements {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .photo-requirements-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 15px;
            font-weight: 600;
            color: #92400e;
            margin-bottom: 10px;
        }
        
        .photo-requirements-list {
            list-style: none;
            font-size: 14px;
            color: #78350f;
            line-height: 1.8;
        }
        
        .photo-requirements-list li {
            position: relative;
            padding-left: 25px;
        }
        
        .photo-requirements-list li::before {
            content: '📸';
            position: absolute;
            left: 0;
            top: 0;
        }
        
        /* Visual Examples */
        .photo-examples {
            display: block;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 12px;
        }
        
        .photo-example-set {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .photo-example-set.hidden {
            display: none;
        }
        
        .photo-example {
            text-align: center;
        }
        
        .photo-example-image {
            width: 100%;
            height: 120px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .photo-example.good .photo-example-image {
            border-color: #10b981;
        }
        
        .photo-example.bad .photo-example-image {
            border-color: #ef4444;
        }
        
        .photo-example-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        .photo-example-icon {
            font-size: 48px;
        }
        
        .photo-example-label {
            font-size: 13px;
            font-weight: 600;
        }
        
        .photo-example.good .photo-example-label {
            color: #059669;
        }
        
        .photo-example.bad .photo-example-label {
            color: #dc2626;
        }
        
        .photo-example-text {
            font-size: 11px;
            color: #64748b;
        }
        
        /* Upload Area - Bigger buttons */
        .upload-area {
            border: 3px dashed #cbd5e0;
            border-radius: 16px;
            padding: 30px 20px;
            text-align: center;
            background: #fafbfc;
            margin-bottom: 20px;
        }
        
        .upload-icon {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #1a4789 0%, #2563eb 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 32px;
            box-shadow: 0 4px 12px rgba(26,71,137,0.2);
        }
        
        .upload-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 20px;
        }
        
        .upload-btn {
            padding: 18px;
            background: white;
            border: 2px solid #1a4789;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            color: #1a4789;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .upload-btn:active {
            transform: scale(0.96);
        }
        
        .upload-btn:hover {
            background: #1a4789;
            color: white;
            box-shadow: 0 4px 12px rgba(26,71,137,0.25);
        }
        
        .upload-btn-icon {
            font-size: 24px;
        }
        
        /* Form Fields - Simplified */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group-label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        label {
            font-size: 15px;
            font-weight: 600;
            color: #2d3748;
        }
        
        .label-tag {
            font-size: 11px;
            font-weight: 500;
            padding: 3px 8px;
            border-radius: 12px;
            background: #f1f5f9;
            color: #64748b;
        }
        
        .label-tag.required {
            background: #fef2f2;
            color: #dc2626;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            font-family: 'Inter', sans-serif;
            transition: all 0.2s ease;
            -webkit-appearance: none;
            background: white;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #1a4789;
            box-shadow: 0 0 0 4px rgba(26,71,137,0.08);
        }
        
        input::placeholder {
            color: #cbd5e0;
        }
        
        /* Navigation Buttons */
        .step-navigation {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }
        
        .nav-btn {
            flex: 1;
            padding: 18px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .nav-btn-back {
            background: white;
            border: 2px solid #e2e8f0;
            color: #64748b;
        }
        
        .nav-btn-back:hover {
            border-color: #cbd5e0;
            background: #f8fafc;
        }
        
        .nav-btn-next {
            background: #1a4789;
            color: white;
        }
        
        .nav-btn-next:hover:not(:disabled) {
            background: #15396e;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(26,71,137,0.3);
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Image Preview - Better */
        .image-preview-container {
            margin-top: 20px;
        }
        
        .image-preview-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        
        .image-preview-title {
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
        }
        
        .image-preview-count {
            display: inline-block;
            background: #1a4789;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .image-preview-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .preview-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            aspect-ratio: 1;
            background: #f1f5f9;
            box-shadow: 0 2px 4px rgba(0,0,0,0.06);
        }
        
        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .preview-item-remove {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 24px;
            height: 24px;
            background: rgba(239,68,68,0.9);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .preview-item-number {
            position: absolute;
            bottom: 5px;
            left: 5px;
            background: rgba(0,0,0,0.75);
            color: white;
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 25px 20px;
            background: #fafbfc;
            color: #64748b;
            font-size: 13px;
            line-height: 1.6;
            border-top: 1px solid #e8ecf0;
            margin-top: auto;
        }
        
        .footer-logo {
            width: 100px;
            margin: 0 auto 15px;
            opacity: 0.8;
        }
        
        .footer strong {
            color: #475569;
            font-weight: 600;
        }
        
        .footer a {
            color: #1a4789;
            text-decoration: none;
            font-weight: 500;
        }
        
        /* Success Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            z-index: 10000;
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal-overlay.show {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 35px 25px;
            max-width: 420px;
            width: 90%;
            text-align: center;
            animation: slideUp 0.4s ease-out;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: scaleIn 0.5s ease-out 0.2s both;
        }
        
        .success-icon svg {
            width: 40px;
            height: 40px;
            stroke: white;
            stroke-width: 3;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: #166534;
            margin-bottom: 12px;
        }
        
        .modal-text {
            font-size: 15px;
            color: #64748b;
            line-height: 1.5;
            margin-bottom: 25px;
        }
        
        .reference-box {
            background: linear-gradient(135deg, #1a4789 0%, #2563eb 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
        }
        
        .reference-label {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        
        .reference-number {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        .reference-note {
            font-size: 12px;
            opacity: 0.85;
        }
        
        .modal-btn {
            width: 100%;
            padding: 16px;
            background: #1a4789;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .modal-btn:hover {
            background: #15396e;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(26,71,137,0.3);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes scaleIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }
        
        /* Hidden elements */
        .hidden {
            display: none !important;
        }
        
        .file-input {
            display: none;
        }
        
        /* Loading states */
        .spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Trust badges */
        .trust-section {
            padding: 20px;
            background: #fafbfc;
            border-top: 1px solid #e2e8f0;
            text-align: center;
        }
        
        .trust-title {
            font-size: 14px;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 12px;
        }
        
        .trust-badges {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .trust-badge {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }
        
        .trust-badge-icon {
            width: 32px;
            height: 32px;
            background: #1a4789;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        .trust-badge-text {
            font-size: 11px;
            color: #64748b;
            font-weight: 500;
        }
        
        /* Mobile optimizations */
        @media (max-width: 480px) {
            .photo-example-set {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .photo-example-image {
                height: 150px;
            }
            
            .upload-buttons {
                grid-template-columns: 1fr;
            }
            
            .trust-badges {
                gap: 15px;
            }
            
            .image-preview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* iPhone notch support */
        @supports (padding: max(0px)) {
            .container {
                padding-top: max(0px, env(safe-area-inset-top));
            }
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Progress Indicator -->
        <div class="progress-indicator">
            <div class="progress-steps">
                <div class="progress-step active" data-step="1">
                    <div class="progress-step-circle">1</div>
                    <div class="progress-step-label">Purpose</div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="progress-step-circle">2</div>
                    <div class="progress-step-label">Photos</div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="progress-step-circle">3</div>
                    <div class="progress-step-label">Contact</div>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="progress-step-circle">4</div>
                    <div class="progress-step-label">Details</div>
                </div>
            </div>
        </div>
        
        <!-- Header -->
        <div class="header">
            <div class="header-logo" style="background: rgba(255,255,255,0.1); padding: 10px;">
                <svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
                    <!-- House icon -->
                    <g stroke="#ffffff" stroke-width="2.5" fill="none">
                        <path d="M8 28 L20 16 L32 28 M10 26 L10 40 L30 40 L30 26"/>
                        <rect x="14" y="30" width="6" height="10"/>
                        <rect x="23" y="30" width="5" height="5"/>
                    </g>
                    <!-- Car icon -->
                    <g stroke="#ffffff" stroke-width="2.5" fill="none">
                        <path d="M28 38 L31 32 L47 32 L50 38 L50 44 L46 44 L46 42 L32 42 L32 44 L28 44 Z"/>
                        <circle cx="35" cy="43" r="2.5" fill="#ffffff"/>
                        <circle cx="43" cy="43" r="2.5" fill="#ffffff"/>
                        <rect x="34" y="34" width="6" height="4" stroke-width="1.5"/>
                        <rect x="42" y="34" width="4" height="4" stroke-width="1.5"/>
                    </g>
                </svg>
            </div>
            <h1>MyInsurancePhoto.com</h1>
            <p>Secure document & photo upload for your insurance needs</p>
        </div>
        
        <form id="imageForm">
            <!-- Step 1: Purpose & Type Selection -->
            <div class="form-step active" data-step="1">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <h2 class="step-title">How can we help you today?</h2>
                    <p class="step-subtitle">Select what you need assistance with</p>
                </div>
                
                <!-- Welcome Benefits -->
                <div class="welcome-section">
                    <div class="benefit-badges">
                        <div class="benefit-badge">
                            <span class="benefit-badge-icon">⚡</span>
                            <span>Fast Processing</span>
                        </div>
                        <div class="benefit-badge">
                            <span class="benefit-badge-icon">🔒</span>
                            <span>Secure Upload</span>
                        </div>
                        <div class="benefit-badge">
                            <span class="benefit-badge-icon">✓</span>
                            <span>Direct to Agent</span>
                        </div>
                    </div>
                </div>
                
                <div class="selection-cards">
                    <!-- Home Insurance -->
                    <div class="selection-card active" data-type="HOME">
                        <div class="selection-card-header">
                            <div class="selection-card-icon">🏠</div>
                            <div class="selection-card-title">Home Insurance</div>
                        </div>
                        <div class="selection-card-description">
                            Upload photos of your home, property, or dwelling for insurance documentation
                        </div>
                    </div>
                    
                    <!-- Auto Insurance -->
                    <div class="selection-card" data-type="VEHICLE">
                        <div class="selection-card-header">
                            <div class="selection-card-icon">🚗</div>
                            <div class="selection-card-title">Auto Insurance</div>
                        </div>
                        <div class="selection-card-description">
                            Upload photos of your vehicle, VIN, or auto documentation for your policy
                        </div>
                    </div>
                </div>
                
                <h3 style="margin: 25px 0 15px; font-size: 16px; font-weight: 600; color: #4a5568;">
                    What type of photos are you uploading?
                </h3>
                
                <div class="selection-cards">
                    <div class="selection-card active" data-purpose="property" style="padding: 20px;">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <span style="font-size: 24px;">🏠</span>
                            <span style="font-size: 16px; font-weight: 600;">Property Photos</span>
                        </div>
                        <div style="font-size: 13px; color: #64748b; padding-left: 36px;">
                            General photos of your home, auto, or insured property for quotes or updates
                        </div>
                    </div>
                    <div class="selection-card" data-purpose="claim" style="padding: 20px;">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <span style="font-size: 24px;">🚨</span>
                            <span style="font-size: 16px; font-weight: 600;">Claim Photos</span>
                        </div>
                        <div style="font-size: 13px; color: #64748b; padding-left: 36px;">
                            Accident photos, damage documentation, exchange forms, or incident reports
                        </div>
                    </div>
                    <div class="selection-card" data-purpose="coverage" style="padding: 20px;">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <span style="font-size: 24px;">📋</span>
                            <span style="font-size: 16px; font-weight: 600;">Coverage Photos</span>
                        </div>
                        <div style="font-size: 13px; color: #64748b; padding-left: 36px;">
                            Photos for adding or changing coverage, new items, or policy adjustments
                        </div>
                    </div>
                    <div class="selection-card" data-purpose="policy" style="padding: 20px;">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <span style="font-size: 24px;">📄</span>
                            <span style="font-size: 16px; font-weight: 600;">Policy Photos</span>
                        </div>
                        <div style="font-size: 13px; color: #64748b; padding-left: 36px;">
                            Insurance documents, renewal forms, or other policy-related paperwork
                        </div>
                    </div>
                </div>
                
                <div class="step-navigation">
                    <button type="button" class="nav-btn nav-btn-next" onclick="nextStep()">
                        <span>Continue</span>
                        <span>→</span>
                    </button>
                </div>
            </div>
            
            <!-- Step 2: Photo Upload -->
            <div class="form-step" data-step="2">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <h2 class="step-title">Upload Your Photos</h2>
                    <p class="step-subtitle">Help us process your request quickly</p>
                </div>
                
                <!-- Photo Requirements -->
                <div class="photo-requirements">
                    <div class="photo-requirements-title">
                        <span>📸</span>
                        <span id="photoReqTitle">What photos we need</span>
                    </div>
                    <ul class="photo-requirements-list" id="photoReqList">
                        <!-- Dynamically populated -->
                    </ul>
                </div>
                
                <!-- Photo Tips with Visual Guides -->
                <div style="background: linear-gradient(135deg, #eff6ff 0%, #f0f9ff 100%); 
                     border-radius: 12px; padding: 15px; margin-bottom: 20px;">
                    <h4 style="font-size: 14px; font-weight: 600; color: #1a4789; margin: 0 0 12px 0; 
                        display: flex; align-items: center; gap: 8px;">
                        <span>💡</span> Quick Photo Tips
                    </h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <img src="https://raw.githubusercontent.com/BillLayne/bill-layne-images/377d90a5e9bb6cceeae1bb14c0bc28e1e0b0c699/Blog%20Images/prompt%205.webp" 
                                 alt="Good photo composition" 
                                 loading="lazy"
                                 style="width: 40px; height: 40px; border-radius: 8px;">
                            <div style="font-size: 12px; color: #059669; font-weight: 600;">
                                Center subject<br>
                                <span style="font-size: 11px; color: #64748b; font-weight: 400;">Get everything in frame</span>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <img src="https://raw.githubusercontent.com/BillLayne/bill-layne-images/377d90a5e9bb6cceeae1bb14c0bc28e1e0b0c699/Blog%20Images/prompt%206.webp" 
                                 alt="Poor photo composition" 
                                 loading="lazy"
                                 style="width: 40px; height: 40px; border-radius: 8px;">
                            <div style="font-size: 12px; color: #dc2626; font-weight: 600;">
                                Avoid these<br>
                                <span style="font-size: 11px; color: #64748b; font-weight: 400;">Partial, tilted, blurry</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Visual Examples -->
                <div class="photo-examples" id="photoExamples">
                    <!-- Home Examples (default) -->
                    <div class="photo-example-set" id="homeExamples">
                        <div class="photo-example good">
                            <div class="photo-example-image">
                                <img src="https://raw.githubusercontent.com/BillLayne/bill-layne-images/377d90a5e9bb6cceeae1bb14c0bc28e1e0b0c699/Blog%20Images/prompt%201.webp" 
                                     alt="Good home photo example" 
                                     loading="lazy"
                                     style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                            <div class="photo-example-label">✓ Good Photo</div>
                            <div class="photo-example-text">Clear, full view</div>
                        </div>
                        <div class="photo-example bad">
                            <div class="photo-example-image">
                                <img src="https://raw.githubusercontent.com/BillLayne/bill-layne-images/377d90a5e9bb6cceeae1bb14c0bc28e1e0b0c699/Blog%20Images/prompt%203.webp" 
                                     alt="Poor home photo example" 
                                     loading="lazy"
                                     style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                            <div class="photo-example-label">✗ Poor Photo</div>
                            <div class="photo-example-text">Dark, partial view</div>
                        </div>
                    </div>
                    
                    <!-- Vehicle Examples (hidden by default) -->
                    <div class="photo-example-set hidden" id="vehicleExamples">
                        <div class="photo-example good">
                            <div class="photo-example-image">
                                <img src="https://raw.githubusercontent.com/BillLayne/bill-layne-images/377d90a5e9bb6cceeae1bb14c0bc28e1e0b0c699/Blog%20Images/prompt%202.webp" 
                                     alt="Good vehicle photo example" 
                                     loading="lazy"
                                     style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                            <div class="photo-example-label">✓ Good Photo</div>
                            <div class="photo-example-text">Well-lit, complete</div>
                        </div>
                        <div class="photo-example bad">
                            <div class="photo-example-image">
                                <img src="https://raw.githubusercontent.com/BillLayne/bill-layne-images/377d90a5e9bb6cceeae1bb14c0bc28e1e0b0c699/Blog%20Images/prompt%204.webp" 
                                     alt="Poor vehicle photo example" 
                                     loading="lazy"
                                     style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                            <div class="photo-example-label">✗ Poor Photo</div>
                            <div class="photo-example-text">Too close, dark</div>
                        </div>
                    </div>
                </div>
                
                <!-- Upload Area -->
                <div class="upload-area">
                    <div class="upload-icon">📷</div>
                    <h3 style="font-size: 18px; font-weight: 600; color: #2d3748; margin-bottom: 8px;">
                        Add Your Photos
                    </h3>
                    <p style="font-size: 14px; color: #64748b;">
                        Take new photos or select from gallery
                    </p>
                    
                    <input type="file" id="fileInput" class="file-input" accept="image/*" multiple>
                    <input type="file" id="cameraInput" class="file-input" accept="image/*" capture="camera">
                    
                    <div class="upload-buttons">
                        <button type="button" class="upload-btn" id="cameraBtn">
                            <span class="upload-btn-icon">📷</span>
                            <span>Camera</span>
                        </button>
                        <button type="button" class="upload-btn" id="galleryBtn">
                            <span class="upload-btn-icon">🖼️</span>
                            <span>Gallery</span>
                        </button>
                    </div>
                </div>
                
                <!-- Image Preview -->
                <div class="image-preview-container hidden" id="imagePreviewContainer">
                    <div class="image-preview-header">
                        <span class="image-preview-title">Uploaded Photos</span>
                        <span class="image-preview-count" id="imageCounter">0</span>
                    </div>
                    <div class="image-preview-grid" id="imagePreview"></div>
                </div>
                
                <div class="step-navigation">
                    <button type="button" class="nav-btn nav-btn-back" onclick="previousStep()">
                        <span>←</span>
                        <span>Back</span>
                    </button>
                    <button type="button" class="nav-btn nav-btn-next" onclick="nextStep()" id="photoNextBtn" disabled>
                        <span>Continue</span>
                        <span>→</span>
                    </button>
                </div>
            </div>
            
            <!-- Step 3: Contact Information -->
            <div class="form-step" data-step="3">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <h2 class="step-title">Your Contact Information</h2>
                    <p class="step-subtitle">So we can follow up with you</p>
                </div>
                
                <div class="form-group">
                    <div class="form-group-label">
                        <label for="customerName">Full Name</label>
                        <span class="label-tag required">Required</span>
                    </div>
                    <input type="text" id="customerName" name="customerName" required 
                           placeholder="John Smith" autocomplete="name">
                </div>
                
                <div class="form-group">
                    <div class="form-group-label">
                        <label for="phone">Phone Number</label>
                        <span class="label-tag required">Required</span>
                    </div>
                    <input type="tel" id="phone" name="phone" required 
                           placeholder="(336) 555-1234" autocomplete="tel">
                </div>
                
                <div class="form-group">
                    <div class="form-group-label">
                        <label for="email">Email Address</label>
                        <span class="label-tag">Optional</span>
                    </div>
                    <input type="email" id="email" name="email" 
                           placeholder="john@example.com" autocomplete="email">
                </div>
                
                <!-- Trust Section -->
                <div class="trust-section">
                    <div class="trust-title">Your information is secure</div>
                    <div class="trust-badges">
                        <div class="trust-badge">
                            <div class="trust-badge-icon">🔒</div>
                            <div class="trust-badge-text">SSL Encrypted</div>
                        </div>
                        <div class="trust-badge">
                            <div class="trust-badge-icon">🛡️</div>
                            <div class="trust-badge-text">Privacy Protected</div>
                        </div>
                        <div class="trust-badge">
                            <div class="trust-badge-icon">🚫</div>
                            <div class="trust-badge-text">No Spam</div>
                        </div>
                    </div>
                </div>
                
                <div class="step-navigation">
                    <button type="button" class="nav-btn nav-btn-back" onclick="previousStep()">
                        <span>←</span>
                        <span>Back</span>
                    </button>
                    <button type="button" class="nav-btn nav-btn-next" onclick="nextStep()">
                        <span>Continue</span>
                        <span>→</span>
                    </button>
                </div>
            </div>
            
            <!-- Step 4: Property/Vehicle Details -->
            <div class="form-step" data-step="4">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <h2 class="step-title" id="detailsTitle">Property Details</h2>
                    <p class="step-subtitle">Additional information for your request</p>
                </div>
                
                <!-- Property Section -->
                <div id="propertySection">
                    <div class="form-group">
                        <div class="form-group-label">
                            <label for="address">Street Address</label>
                            <span class="label-tag">Optional</span>
                        </div>
                        <input type="text" id="address" name="address" 
                               placeholder="123 Main Street" autocomplete="street-address">
                    </div>
                    
                    <div class="form-group">
                        <div class="form-group-label">
                            <label for="city">City</label>
                            <span class="label-tag">Optional</span>
                        </div>
                        <input type="text" id="city" name="city" 
                               placeholder="Elkin" autocomplete="address-level2">
                    </div>
                    
                    <div class="form-group">
                        <div class="form-group-label">
                            <label for="state">State</label>
                            <span class="label-tag">Optional</span>
                        </div>
                        <select id="state" name="state" autocomplete="address-level1">
                            <option value="">Select State</option>
                            <option value="NC" selected>North Carolina</option>
                            <option value="SC">South Carolina</option>
                            <option value="VA">Virginia</option>
                            <option value="TN">Tennessee</option>
                            <option value="GA">Georgia</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <div class="form-group-label">
                            <label for="zip">ZIP Code</label>
                            <span class="label-tag">Optional</span>
                        </div>
                        <input type="text" id="zip" name="zip" 
                               placeholder="28621" autocomplete="postal-code" 
                               pattern="[0-9]{5}" maxlength="5">
                    </div>
                </div>
                
                <!-- Vehicle Section -->
                <div id="vehicleSection" class="hidden">
                    <div class="form-group">
                        <div class="form-group-label">
                            <label for="vehicleInfo">Vehicle Details</label>
                            <span class="label-tag">Optional</span>
                        </div>
                        <input type="text" id="vehicleInfo" name="vehicleInfo" 
                               placeholder="2024 Toyota Camry or VIN#">
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="form-group-label">
                        <label for="notes">Additional Information</label>
                        <span class="label-tag">Optional</span>
                    </div>
                    <textarea id="notes" name="notes" rows="4" 
                              placeholder="Any special details or questions..."></textarea>
                </div>
                
                <div class="step-navigation">
                    <button type="button" class="nav-btn nav-btn-back" onclick="previousStep()">
                        <span>←</span>
                        <span>Back</span>
                    </button>
                    <button type="submit" class="nav-btn nav-btn-next" id="submitBtn">
                        <span id="btnText">Submit to Agency</span>
                        <div class="spinner" id="spinner"></div>
                    </button>
                </div>
            </div>
        </form>
        
        <!-- Footer -->
        <div class="footer">
            <div style="margin: 0 auto 15px; opacity: 0.7;">
                <svg width="50" height="50" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
                    <!-- House icon -->
                    <g stroke="#64748b" stroke-width="2" fill="none">
                        <path d="M8 28 L20 16 L32 28 M10 26 L10 40 L30 40 L30 26"/>
                        <rect x="14" y="30" width="6" height="10"/>
                        <rect x="23" y="30" width="5" height="5"/>
                    </g>
                    <!-- Car icon -->
                    <g stroke="#64748b" stroke-width="2" fill="none">
                        <path d="M28 38 L31 32 L47 32 L50 38 L50 44 L46 44 L46 42 L32 42 L32 44 L28 44 Z"/>
                        <circle cx="35" cy="43" r="2.5" fill="#64748b"/>
                        <circle cx="43" cy="43" r="2.5" fill="#64748b"/>
                        <rect x="34" y="34" width="6" height="4" stroke-width="1.5"/>
                        <rect x="42" y="34" width="4" height="4" stroke-width="1.5"/>
                    </g>
                </svg>
            </div>
            <div>
                <strong>Bill Layne Insurance Agency</strong><br>
                1283 N Bridge St, Elkin NC 28621<br>
                <a href="tel:3368351993">336-835-1993</a> | 
                <a href="mailto:Save@BillLayneInsurance.com">Save@BillLayneInsurance.com</a><br>
                <a href="https://www.BillLayneInsurance.com">www.BillLayneInsurance.com</a>
            </div>
        </div>
    </div>
    
    <!-- Success Modal -->
    <div class="modal-overlay" id="successModal">
        <div class="modal-content">
            <div class="success-icon">
                <svg viewBox="0 0 24 24">
                    <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
            </div>
            <h2 class="modal-title">Success! Submission Received</h2>
            <p class="modal-text">
                Thank you for choosing Bill Layne Insurance! We've received your information and will review it promptly. Our team will contact you as soon as possible.
            </p>
            <div class="reference-box">
                <div class="reference-label">Your Reference Number</div>
                <div class="reference-number" id="confirmNumber">BLI-240101-0000</div>
                <div class="reference-note">Please save this for your records</div>
            </div>
            <button class="modal-btn" onclick="closeSuccessModal()">Done</button>
        </div>
    </div>
    
    <!-- Upload Progress Modal -->
    <div class="modal-overlay" id="uploadProgress">
        <div class="modal-content">
            <div style="width: 64px; height: 64px; margin: 0 auto 20px;">
                <div class="spinner" style="display: block; width: 64px; height: 64px; border-width: 4px;"></div>
            </div>
            <h2 style="font-size: 20px; font-weight: 700; color: #1a4789; margin-bottom: 12px;">
                Uploading Your Photos
            </h2>
            <p style="font-size: 14px; color: #64748b; margin-bottom: 20px;">
                Please wait while we securely upload your images...
            </p>
            <div style="background: #f1f5f9; border-radius: 20px; height: 8px; overflow: hidden;">
                <div id="progressBar" style="height: 100%; background: linear-gradient(90deg, #1a4789 0%, #2563eb 100%); 
                     border-radius: 20px; width: 0%; transition: width 0.5s ease;"></div>
            </div>
            <p style="margin-top: 15px; font-size: 13px; color: #94a3b8;">
                <span id="uploadStatus">Preparing upload...</span>
            </p>
        </div>
    </div>
    
    <script>
        // Configuration
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzgRcVZgCDznG5bBTLpAxun6enA4OP4k6HQhYHYeyq4nkFNKxBkFg3QVQr5n9p9olAlag/exec';
        const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB
        const MAX_IMAGES = 20;
        
        // State
        let currentStep = 1;
        let selectedType = 'HOME';
        let selectedPurpose = 'property';
        let uploadedImages = [];
        
        // Photo requirements by type and purpose
        const photoRequirements = {
            'HOME-property': [
                'Front view of your home',
                'Back view of your home', 
                'Left and right side views',
                'Roof angle (best visible angle)',
                'Any detached structures (garage, shed)',
                'Special features (pool, deck, solar panels)'
            ],
            'HOME-claim': [
                'All damaged areas (wide and close-up shots)',
                'Cause of damage if visible',
                'Affected rooms from multiple angles',
                'Damaged personal property',
                'Overall context showing extent'
            ],
            'HOME-coverage': [
                'New additions or improvements',
                'Recent renovations or upgrades',
                'Updated systems (HVAC, electrical, plumbing)',
                'New structures or features',
                'Current condition photos'
            ],
            'HOME-policy': [
                'Current insurance documents',
                'Declaration pages',
                'Renewal notices',
                'Recent inspection reports',
                'Any requested documentation'
            ],
            'VEHICLE-property': [
                'All 4 sides of vehicle',
                'VIN number (dashboard or door frame)',
                'Current odometer reading',
                'License plates (front and back)',
                'Interior condition'
            ],
            'VEHICLE-claim': [
                'All damage areas from multiple angles',
                'Impact points and close-ups',
                'Other vehicles involved',
                'Accident scene if safe',
                'Police report or exchange forms'
            ],
            'VEHICLE-coverage': [
                'New vehicle all angles',
                'Modifications or upgrades',
                'Custom equipment added',
                'Current condition',
                'Purchase documentation'
            ],
            'VEHICLE-policy': [
                'Current insurance card',
                'Registration documents',
                'Title or ownership docs',
                'Inspection certificates',
                'Driver licenses if requested'
            ]
        };
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updatePhotoRequirements();
        });
        
        // Setup Event Listeners
        function setupEventListeners() {
            // Type selection
            document.querySelectorAll('.selection-card[data-type]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.selection-card[data-type]').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    selectedType = this.dataset.type;
                    updatePhotoRequirements();
                });
            });
            
            // Purpose selection
            document.querySelectorAll('.selection-card[data-purpose]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.selection-card[data-purpose]').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    selectedPurpose = this.dataset.purpose;
                    updatePhotoRequirements();
                });
            });
            
            // Camera button
            document.getElementById('cameraBtn').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('cameraInput').click();
            });
            
            // Gallery button
            document.getElementById('galleryBtn').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('fileInput').click();
            });
            
            // File inputs
            document.getElementById('fileInput').addEventListener('change', handleFileSelect);
            document.getElementById('cameraInput').addEventListener('change', handleFileSelect);
            
            // Form submission
            document.getElementById('imageForm').addEventListener('submit', handleSubmit);
            
            // Phone formatting
            document.getElementById('phone').addEventListener('input', formatPhone);
            
            // ZIP formatting
            document.getElementById('zip').addEventListener('input', function(e) {
                e.target.value = e.target.value.replace(/\D/g, '').slice(0, 5);
            });
        }
        
        // Navigation functions
        function nextStep() {
            // Validate current step
            if (currentStep === 2 && uploadedImages.length === 0) {
                alert('Please upload at least one photo to continue');
                return;
            }
            
            if (currentStep === 3) {
                const name = document.getElementById('customerName').value;
                const phone = document.getElementById('phone').value;
                if (!name || !phone) {
                    alert('Please fill in all required fields');
                    return;
                }
            }
            
            if (currentStep < 4) {
                currentStep++;
                showStep(currentStep);
            }
        }
        
        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }
        
        function showStep(step) {
            // Hide all steps
            document.querySelectorAll('.form-step').forEach(s => s.classList.remove('active'));
            
            // Show current step
            document.querySelector(`.form-step[data-step="${step}"]`).classList.add('active');
            
            // Update progress
            document.querySelectorAll('.progress-step').forEach((s, index) => {
                if (index + 1 < step) {
                    s.classList.add('completed');
                    s.classList.remove('active');
                } else if (index + 1 === step) {
                    s.classList.add('active');
                    s.classList.remove('completed');
                } else {
                    s.classList.remove('active', 'completed');
                }
            });
            
            // Update details for step 4
            if (step === 4) {
                const titleEl = document.getElementById('detailsTitle');
                const propSection = document.getElementById('propertySection');
                const vehSection = document.getElementById('vehicleSection');
                
                if (selectedType === 'HOME') {
                    titleEl.textContent = 'Property Details';
                    propSection.classList.remove('hidden');
                    vehSection.classList.add('hidden');
                } else {
                    titleEl.textContent = 'Vehicle Details';
                    propSection.classList.add('hidden');
                    vehSection.classList.remove('hidden');
                }
            }
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Update photo requirements
        function updatePhotoRequirements() {
            const key = `${selectedType}-${selectedPurpose}`;
            const requirements = photoRequirements[key] || [];
            
            const listEl = document.getElementById('photoReqList');
            if (listEl) {
                listEl.innerHTML = requirements.map(req => `<li>${req}</li>`).join('');
            }
            
            // Update title
            const titleEl = document.getElementById('photoReqTitle');
            if (titleEl) {
                if (selectedPurpose === 'property') {
                    titleEl.textContent = 'Property photos needed:';
                } else if (selectedPurpose === 'claim') {
                    titleEl.textContent = 'Document all damage and incident details:';
                } else if (selectedPurpose === 'coverage') {
                    titleEl.textContent = 'Photos for coverage update:';
                } else {
                    titleEl.textContent = 'Policy documentation needed:';
                }
            }
            
            // Toggle photo examples based on type
            const homeExamples = document.getElementById('homeExamples');
            const vehicleExamples = document.getElementById('vehicleExamples');
            
            if (homeExamples && vehicleExamples) {
                if (selectedType === 'HOME') {
                    homeExamples.classList.remove('hidden');
                    vehicleExamples.classList.add('hidden');
                } else {
                    homeExamples.classList.add('hidden');
                    vehicleExamples.classList.remove('hidden');
                }
            }
        }
        
        // Handle file selection
        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            processFiles(files);
            e.target.value = ''; // Reset input
        }
        
        // Process files
        function processFiles(files) {
            const remainingSlots = MAX_IMAGES - uploadedImages.length;
            
            if (remainingSlots <= 0) {
                alert('Maximum 20 images allowed');
                return;
            }
            
            const filesToProcess = files.slice(0, remainingSlots);
            
            filesToProcess.forEach(file => {
                if (file.size > MAX_FILE_SIZE) {
                    alert(`${file.name} is too large. Maximum size is 10MB`);
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedImages.push({
                        data: e.target.result,
                        type: file.type,
                        name: file.name
                    });
                    displayImages();
                    updateImageCounter();
                };
                reader.readAsDataURL(file);
            });
        }
        
        // Display images
        function displayImages() {
            const container = document.getElementById('imagePreviewContainer');
            const preview = document.getElementById('imagePreview');
            
            if (uploadedImages.length > 0) {
                container.classList.remove('hidden');
                document.getElementById('photoNextBtn').disabled = false;
            } else {
                container.classList.add('hidden');
                document.getElementById('photoNextBtn').disabled = true;
            }
            
            preview.innerHTML = '';
            
            uploadedImages.forEach((image, index) => {
                const item = document.createElement('div');
                item.className = 'preview-item';
                item.innerHTML = `
                    <img src="${image.data}" alt="Image ${index + 1}">
                    <button type="button" class="preview-item-remove" onclick="removeImage(${index})">×</button>
                    <span class="preview-item-number">${index + 1}</span>
                `;
                preview.appendChild(item);
            });
        }
        
        // Remove image
        function removeImage(index) {
            uploadedImages.splice(index, 1);
            displayImages();
            updateImageCounter();
        }
        
        // Update counter
        function updateImageCounter() {
            document.getElementById('imageCounter').textContent = uploadedImages.length;
        }
        
        // Handle form submission
        async function handleSubmit(e) {
            e.preventDefault();
            
            if (uploadedImages.length === 0) {
                alert('Please upload at least one photo');
                return;
            }
            
            // Show upload progress
            document.getElementById('uploadProgress').classList.add('show');
            document.getElementById('progressBar').style.width = '10%';
            document.getElementById('uploadStatus').textContent = 'Preparing your submission...';
            
            // Generate reference number
            const referenceNumber = generateReferenceNumber();
            
            // Prepare data
            const formData = new FormData(e.target);
            const data = {
                type: selectedType,
                purpose: selectedPurpose,
                customerName: formData.get('customerName'),
                phone: formData.get('phone'),
                email: formData.get('email'),
                address: formData.get('address'),
                city: formData.get('city'),
                state: formData.get('state'),
                zip: formData.get('zip'),
                vehicleInfo: formData.get('vehicleInfo'),
                notes: formData.get('notes'),
                referenceNumber: referenceNumber,
                images: uploadedImages,
                submittedAt: new Date().toISOString()
            };
            
            // Update progress
            document.getElementById('progressBar').style.width = '50%';
            document.getElementById('uploadStatus').textContent = 'Uploading photos...';
            
            try {
                // Submit to Google Apps Script
                await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                // Update progress
                document.getElementById('progressBar').style.width = '100%';
                document.getElementById('uploadStatus').textContent = 'Complete!';
                
                // Wait a moment
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Hide upload modal
                document.getElementById('uploadProgress').classList.remove('show');
                
                // Update confirmation number
                document.getElementById('confirmNumber').textContent = referenceNumber;
                
                // Show success modal
                document.getElementById('successModal').classList.add('show');
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('uploadProgress').classList.remove('show');
                alert('Upload failed. Please try again or call us at 336-835-1993');
            }
        }
        
        // Generate reference number
        function generateReferenceNumber() {
            const date = new Date();
            const year = date.getFullYear().toString().slice(-2);
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
            return `BLI-${year}${month}${day}-${random}`;
        }
        
        // Format phone
        function formatPhone() {
            const input = document.getElementById('phone');
            let value = input.value.replace(/\D/g, '');
            
            if (value.length > 0) {
                if (value.length <= 3) {
                    value = `(${value}`;
                } else if (value.length <= 6) {
                    value = `(${value.slice(0, 3)}) ${value.slice(3)}`;
                } else {
                    value = `(${value.slice(0, 3)}) ${value.slice(3, 6)}-${value.slice(6, 10)}`;
                }
            }
            
            input.value = value;
        }
        
        // Close success modal
        function closeSuccessModal() {
            document.getElementById('successModal').classList.remove('show');
            // Reset form
            document.getElementById('imageForm').reset();
            uploadedImages = [];
            displayImages();
            updateImageCounter();
            currentStep = 1;
            showStep(1);
        }
    </script>
</body>
</html>